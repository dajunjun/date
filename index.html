<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="css/style.css"/>
    <title>模拟IOSselect</title>
</head>  
<body>
<div id="address">
    <span>日期选择：</span>

    <div class="falseAdd"></div>
</div>
<div id="choiceCity">
    <div id="wrapper">
        <div id="scroller">
            <ul>
            </ul>
        </div>
    </div>
    <div id="wrapper2">
        <div id="scroller2">
            <ul>
                <li></li>
                <li class="active">01</li>
                <li>02</li>
                <li>03</li>
                <li>04</li>
                <li>05</li>
                <li>06</li>
                <li>07</li>
                <li>08</li>
                <li>09</li>
                <li>10</li>
                <li>11</li>
                <li>12</li>
                <li></li>

            </ul>
        </div>
    </div>
    <div id="wrapper3">
        <div id="scroller3">
            <ul>
                <li></li>

            </ul>
        </div>
    </div>
    <div class="selectedLine1"></div>
    <div class="selectedLine2"></div>
    <button id="btn">确定</button>
</div>
<script type="text/javascript" src="js/iscroll.js"></script>
<script type="text/javascript" src="js/zepto.js"></script>
<!--<script type="text/javascript" src="js/jquery.transit.min.js"></script>-->

<script type="text/javascript">
    areaInfo = [
        ["安徽", "合肥|宿州|淮北|亳州|阜阳|蚌埠|淮南|滁州|马鞍山|芜湖|铜陵|安庆|黄山|六安|巢湖|池州|宣城",
            "庐阳区&瑶海区&蜀山区&包河区&长丰县&水湖镇&肥东县&店埠镇&肥西县&上派镇|埇桥区&砀山县&砀城镇&萧县&龙城镇&灵璧县&灵城镇&泗县&泗城镇|相山区&杜集区&烈山区&濉溪县&濉溪镇|亳州1&亳州2&亳州3&亳州4&亳州5&亳州6|六安|宣城|宿州|巢湖|池州|淮北|淮南|滁州|蚌埠|铜陵|阜阳|马鞍山|黄山"],
        ["北京", "北京", "东城区&西城区&崇文区&宣武区&朝阳区&丰台区&石景山区&海淀区&门头沟区&房山区&通州区&顺义区&昌平区&大兴区&怀柔区&平谷区&密云县&延庆县&延庆镇"],
        ["天津", "天津", "和平区&河东区&河西区&南开区&河北区&红桥区&塘沽区&汉沽区&大港区&东丽区&西青区&津南区&北辰区&武清区&宝坻区&蓟县&宁河县&芦台镇&静海县&静海镇"],
        ["河北", "石家庄|保定|唐山|廊坊|张家口|承德|沧州|秦皇岛|衡水|邢台|邯郸",
            "长安区&桥东区&桥西区&新华区&裕华区&井陉矿区&辛集市&藁城市&晋州市&新乐市&鹿泉市&井陉县&微水镇&正定县&正定镇&栾城县&栾城镇&行唐县&龙州镇&灵寿县&灵寿镇&高邑县&高邑镇&深泽县&深泽镇&赞皇县&赞皇镇&无极县&无极镇&平山县&平山镇&元氏县&槐阳镇&赵县&赵州镇|桥西区&桥东区&宣化区&下花园区&宣化县&张家口市宣化区&张北县&张北镇&康保县&康保镇&沽源县&平定堡镇&尚义县&南壕堑镇&蔚县&蔚州镇&阳原县&西城镇&怀安县&柴沟堡镇&万全县&孔家庄镇&怀来县&沙城镇&涿鹿县&涿鹿镇&赤城县&赤城镇&崇礼县&西湾子镇|双桥区&双滦区&鹰手营子矿区&承德县&下板城镇&兴隆县&兴隆镇&平泉县&平泉镇&滦平县&滦平镇&隆化县&隆化镇&丰宁满族自治县&大阁镇&宽城满族自治县&宽城镇&围场满族蒙古族自治县&围场镇|廊坊1&廊坊2&廊坊3&廊坊4&廊坊5&廊坊6|张家口|承德|沧州|秦皇岛|衡水|邢台|邯郸"],
        ["山西", "太原|大同|临汾|吕梁|忻州|晋中|晋城|朔州|运城|长治|阳泉", "太原|大同|临汾|吕梁|忻州|晋中|晋城|朔州|运城|长治|阳泉"],
        ["内蒙古", "呼和浩特|包头|赤峰|呼伦贝尔|乌兰察布|通辽|乌海|兴安盟|巴彦淖尔|鄂尔多斯|锡林郭勒盟|阿拉善盟", "呼和浩特|包头|赤峰|呼伦贝尔|乌兰察布|通辽|乌海|兴安盟|巴彦淖尔|鄂尔多斯|锡林郭勒盟|阿拉善盟"],
        ["辽宁", "沈阳|大连|葫芦岛|丹东|抚顺|朝阳|本溪|盘锦|营口|辽阳|铁岭|锦州|阜新|鞍山", "沈阳|大连|葫芦岛|丹东|抚顺|朝阳|本溪|盘锦|营口|辽阳|铁岭|锦州|阜新|鞍山"],
        ["吉林", "长春|吉林|通化|四平|松原|白城|白山|辽源|延边州", "长春|吉林|通化|四平|松原|白城|白山|辽源|延边州"],
        ["黑龙江", "哈尔滨|大庆|佳木斯|鹤岗|七台河|伊春|双鸭山|牡丹江|绥化|鸡西|黑河|齐齐哈尔|大兴安岭", "哈尔滨|大庆|佳木斯|鹤岗|七台河|伊春|双鸭山|牡丹江|绥化|鸡西|黑河|齐齐哈尔|大兴安岭"],
        ["上海", "上海", "黄浦区&卢湾区&徐汇区&长宁区&静安区&普陀区&闸北区&虹口区&杨浦区&闵行区&宝山区&嘉定区&浦东新区&金山区&松江区&青浦区&南汇区&奉贤区&崇明县&城桥镇"],
        ["江苏", "南京|苏州|南通|宿迁|常州|徐州|扬州|无锡|泰州|淮安|盐城|连云港|镇江", "南京|苏州|南通|宿迁|常州|徐州|扬州|无锡|泰州|淮安|盐城|连云港|镇江"],
        ["浙江", "杭州|宁波|绍兴|温州|台州|嘉兴|丽水|湖州|舟山|衢州|金华", "杭州|宁波|绍兴|温州|台州|嘉兴|丽水|湖州|舟山|衢州|金华"],
        ["福建", "福州|厦门|泉州|漳州|三明|南平|宁德|莆田|龙岩", "福州|厦门|泉州|漳州|三明|南平|宁德|莆田|龙岩"],
        ["江西", "南昌|九江|抚州|赣州|上饶|吉安|宜春|新余|景德镇|萍乡|鹰潭", "南昌|九江|抚州|赣州|上饶|吉安|宜春|新余|景德镇|萍乡|鹰潭"],
        ["山东", "济南|青岛|威海|泰安|德州|日照|枣庄|济宁|淄博|滨州|潍坊|烟台|聊城|莱芜|菏泽|东营|临沂", "济南|青岛|威海|泰安|德州|日照|枣庄|济宁|淄博|滨州|潍坊|烟台|聊城|莱芜|菏泽|东营|临沂"],
        ["河南", "郑州|洛阳|濮阳|安阳|三门峡|信阳|南阳|周口|商丘|平顶山|开封|新乡|济源|漯河|焦作|许昌|驻马店|鹤壁", "郑州|洛阳|濮阳|安阳|三门峡|信阳|南阳|周口|商丘|平顶山|开封|新乡|济源|漯河|焦作|许昌|驻马店|鹤壁"],
        ["湖北", "武汉|荆州|荆门|襄阳|仙桃|十堰|咸宁|天门|孝感|宜昌|恩施|潜江|神农架|鄂州|随州|黄冈|黄石", "武汉|荆州|荆门|襄阳|仙桃|十堰|咸宁|天门|孝感|宜昌|恩施|潜江|神农架|鄂州|随州|黄冈|黄石"],
        ["湖南", "长沙|株洲|湘潭|娄底|岳阳|常德|张家界|怀化|永州|湘西州|益阳|衡阳|邵阳|郴州", "长沙|株洲|湘潭|娄底|岳阳|常德|张家界|怀化|永州|湘西州|益阳|衡阳|邵阳|郴州"],
        ["广东", "广州|深圳|东莞|茂名|中山|云浮|佛山|惠州|揭阳|梅州|汕头|汕尾|江门|河源|清远|湛江|潮州|珠海|肇庆|阳江|韶关", "广州|深圳|东莞|茂名|中山|云浮|佛山|惠州|揭阳|梅州|汕头|汕尾|江门|河源|清远|湛江|潮州|珠海|肇庆|阳江|韶关"],
        ["广西", "南宁|桂林|北海|柳州|玉林|崇左|来宾|梧州|河池|百色|贵港|贺州|钦州|防城港", "南宁|桂林|北海|柳州|玉林|崇左|来宾|梧州|河池|百色|贵港|贺州|钦州|防城港"],
        ["海南", "海口|三亚|省直辖", "海口|三亚|省直辖"],
        ["重庆", "重庆", "渝中区&大渡口区&江北区&沙坪坝区&九龙坡区&南岸区&北碚区&万盛区&双桥区&渝北区&巴南区&万州区&涪陵区&黔江区&长寿区&合川市&永川区市&江津市&南川市&綦江县&潼南县&铜梁县&大足县&荣昌县&璧山县&垫江县&武隆县&丰都县&城口县&梁平县&开县&巫溪县&巫山县&奉节县&云阳县&忠县&石柱土家族自治县&彭水苗族土家族自治县&酉阳土家族苗族自治县&秀山土家族苗族自治县"],
        ["四川", "成都|绵阳|乐山|德阳|内江|南充|宜宾|巴中|广元|广安|攀枝花|泸州|眉山|自贡|资阳|达州|遂宁|雅安|甘孜州|凉山州|阿坝州", "成都|绵阳|乐山|德阳|内江|南充|宜宾|巴中|广元|广安|攀枝花|泸州|眉山|自贡|资阳|达州|遂宁|雅安|甘孜州|凉山州|阿坝州"],
        ["贵州", "贵阳|遵义|六盘水|安顺|毕节|铜仁|黔东南州|黔南州|黔西南州", "贵阳|遵义|六盘水|安顺|毕节|铜仁|黔东南州|黔南州|黔西南州"],
        ["云南", "昆明|玉溪|丽江|保山|临沧|普洱|曲靖|大理州|德宏州|怒江州|迪庆州|文山州|昭通|楚雄州|红河州|西双版纳州", "昆明|玉溪|丽江|保山|临沧|普洱|曲靖|大理州|德宏州|怒江州|迪庆州|文山州|昭通|楚雄州|红河州|西双版纳州"],
        ["西藏", "拉萨|日喀则|昌都|林芝|阿里|山南", "拉萨|日喀则|昌都|林芝|阿里|山南"],
        ["陕西", "西安|咸阳|宝鸡|榆林|汉中|延安|渭南|铜川|商洛|安康", "西安|咸阳|宝鸡|榆林|汉中|延安|渭南|铜川|商洛|安康"],
        ["甘肃", "兰州|天水|张掖|武威|白银|酒泉|嘉峪关|定西|平凉|庆阳|金昌|陇南|临夏|甘南州", "兰州|天水|张掖|武威|白银|酒泉|嘉峪关|定西|平凉|庆阳|金昌|陇南|临夏|甘南州"],
        ["青海", "西宁|果洛州|海东|海北州|海南州|海西州|玉树州|黄南州", "西宁|果洛州|海东|海北州|海南州|海西州|玉树州|黄南州"],
        ["宁夏", "银川|中卫|吴忠|固原|石嘴山", "银川|中卫|吴忠|固原|石嘴山"],
        ["新疆", "乌鲁木齐|克拉玛依|吐鲁番|塔城|喀什|伊犁州|巴音郭楞州|昌吉州|石河子|阿克苏|阿勒泰|克孜勒苏柯尔克孜州|博尔塔拉州|和田|哈密|五家渠|阿拉尔", "乌鲁木齐|克拉玛依|吐鲁番|塔城|喀什|伊犁州|巴音郭楞州|昌吉州|石河子|阿克苏|阿勒泰|克孜勒苏柯尔克孜州|博尔塔拉州|和田|哈密|五家渠|阿拉尔"]
    ];

    //    输出省
    var tempLiInnerHTML = "";
    var tempCityInnerHTML = "";
    var tempCountyInnerHTML = "";
    var yearHtml = "";
    var monthHtml = "";
    var nowDate = new Date();
    var nowYear = nowDate.getFullYear();
    var endMouth = 1900;

    var tempYear=nowYear;


    function DayNumOfMonth(Year, Month) { //获取指定年的月的天数
        return 32 - new Date(Year, Month, 32).getDate();
    }

    /*
     function DayNumOfMonth(Year, Month) { //获取指定年的月的天数
     Month--;
     var d = new Date(Year, Month, 1);
     d.setDate(d.getDate() + 32 - d.getDate());
     return (32 - d.getDate());
     }
     */


    for (var y = nowYear; y >= 1900; y--) {
        yearHtml += "<li>" + y + "</li>"
    }
    var oli = "<li></li>";

    $("#scroller ul").html(oli + yearHtml + oli);
    $("#scroller ul li").eq(1).addClass("active");


    //日
    for (var m = 1; m < 32; m++) {
        monthHtml += "<li>" + m + "</li>"
    }

    $("#scroller3 ul").html(oli + monthHtml + oli);
    $("#scroller3 ul li").eq(1).addClass("active");


    //    输出省

    var myScroll;
    var myScroll2;
    var myScroll3;

    myScroll = new IScroll('#wrapper', {
        scrollY: true,
        mouseWheel: true,
        snap: "li"
    });
    myScroll.on("scrollEnd", function () {
        var monthHtml="";
        var activeIndex = Math.abs(myScroll.y) / 40;
        $("#scroller li").removeClass("active");
        $("#scroller2 ul li").removeClass("active");
        $("#scroller li").eq(activeIndex + 1).addClass("active");
        console.log($("#scroller li").eq(activeIndex + 1).html());
        tempYear=$("#scroller li").eq(activeIndex + 1).html()

//        var changeCity = areaInfo[activeIndex][1].split("|");


        $("#scroller2 ul li").eq(1).addClass("active");
        myScroll2 = new IScroll('#wrapper2', {
            scrollY: true,
            mouseWheel: true,
            snap: "li"
        });


        var tempMonthDays=DayNumOfMonth(tempYear,0)
        for (var m = 1; m <= tempMonthDays; m++) {
            monthHtml += "<li>" + m + "</li>"
        }

        $("#scroller3 ul").html(oli + monthHtml + oli);
        $("#scroller3 ul li").eq(1).addClass("active");
        myScroll3 = new IScroll('#wrapper3', {
            scrollY: true,
            mouseWheel: true,
            snap: "li"
        });
    });


    myScroll2 = new IScroll('#wrapper2', {
        scrollY: true,
        mouseWheel: true,
        snap: "li"
    });

    myScroll2.on("scrollEnd", function () {     //市 停止滚动的时候
        var cityIndex = null;
        var countyHtml = "";
        var tempCountyHtml = "";
        var activeIndex = Math.abs(myScroll2.y) / 40;
        var monthHtml="";

        $("#scroller2 li").removeClass("active");
        $("#scroller2 li").eq(activeIndex + 1).addClass("active")
        console.log("dddd" + activeIndex)
        console.log(tempYear)
        console.log(DayNumOfMonth(tempYear,activeIndex))
        var tempMonthDays=DayNumOfMonth(tempYear,activeIndex)
        for (var m = 1; m <= tempMonthDays; m++) {
            monthHtml += "<li>" + m + "</li>"
        }

        $("#scroller3 ul").html(oli + monthHtml + oli);
        $("#scroller3 ul li").eq(1).addClass("active");

/*





        for (var e = 0; e < $("#scroller li").length; e++) {
            if ($("li").eq(e).hasClass("active")) {
                cityIndex = e;
            }
        }
        console.log(areaInfo[cityIndex - 1][2].split("|")[activeIndex])
        var countyHtml = areaInfo[cityIndex - 1][2].split("|")[activeIndex].split("&");

        for (var r = 0; r < countyHtml.length; r++) {//输出省
            tempCountyHtml += "<li>" + countyHtml[r] + "</li>"
        }
        console.log(tempCountyHtml)

        $("#scroller3 ul").html(oli + tempCountyHtml + oli);
        $("#scroller3 ul li").eq(1).addClass("active");*/

        myScroll3 = new IScroll('#wrapper3', {
            scrollY: true,
            mouseWheel: true,
            snap: "li"
        });
        myScroll3.on("scrollEnd", function () {//县级城市  停止滚动的时候
            var activeIndex = Math.abs(myScroll3.y) / 40;
            $("#scroller3 li").removeClass("active");
            $("#scroller3 li").eq(activeIndex + 1).addClass("active")
        });

    });
    myScroll3 = new IScroll('#wrapper3', {
        scrollY: true,
        mouseWheel: true,
        snap: "li"
    });
    myScroll3.on("scrollEnd", function () {//县级城市  停止滚动的时候
        var activeIndex = Math.abs(myScroll3.y) / 40;
        $("#scroller3 li").removeClass("active");
        $("#scroller3 li").eq(activeIndex + 1).addClass("active")
    });
    document.addEventListener('touchmove', function (e) {
        e.preventDefault();
    }, false);


    $("#address").on("click", function () {//点击城市选择出现
        var o = document.body;
        var div = document.createElement("div");
        div.className = "tempDiv";
        o.appendChild(div);
        $("#choiceCity").css({"display": "block", "z-index": "999"});
    });


    $("#choiceCity").css({"display": "none"});
    $("#btn").on("click", function () {//点击把选中的li中的内容赋值给伪表单
        var str = ""
        for (var i = 0; i < $("li").length; i++) {
            if ($("li").eq(i).hasClass("active")) {
                str += $("li").eq(i).html();
            }
            $(".falseAdd").html(str);
            $("#choiceCity").css({"display": "none"});
            $(".tempDiv").css({"display": "none"});

        }
    })
</script>
</body>
</html>